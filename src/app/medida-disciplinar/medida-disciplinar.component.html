<!-- Navbar -->
<nav>
  <div class="bg-greenTMKT h-16 flex flex-wrap justify-between items-center px-4">
    <div class="w-14 flex-shrink-0">
      <img src="assets/logo des.grafico.png" alt="logoTMKT">
    </div>
    <div class="text-lg p-3">
      <p class="text-white hover:text-gray-300 truncate cursor-pointer">{{ nrreg }} - {{ nome }}</p>
    </div>
    <h1 class="text-white text-lg font-medium absolute left-1/2 transform -translate-x-1/2">
      Medida Disciplinar - Assinatura Digital
    </h1>
    <div class="ml-auto text-lg flex-shrink-0">
      <a href="/logout" class="text-white hover:text-gray-300">Sair</a>
    </div>
  </div>
</nav>

<!-- Tabela -->
<div class="relative overflow-x-auto shadow-md sm:rounded-lg">
  <table class="min-w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
      <tr>
        <th scope="col" class="p-4"></th>
        <th scope="col" class="px-4 py-3">Ação</th>
        <th scope="col" class="px-4 py-3">Matricula</th>
        <th scope="col" class="px-4 py-3">Nome</th>
        <th scope="col" class="px-4 py-3">Ocorrência</th>
        <th scope="col" class="px-4 py-3">Id</th>
        <th scope="col" class="px-4 py-3">Descrição</th>
        <th scope="col" class="px-4 py-3">Data</th>
        <th scope="col" class="px-4 py-3">Sanção</th>
        <th scope="col" class="px-4 py-3">Superior</th>
        <th scope="col" class="px-4 py-3">Matricula Superior</th>
        <th scope="col" class="px-4 py-3">Situação</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let measure of listDisciplinaryMeasure; trackBy: trackByMeasureId" class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
        <td class="w-4 p-4"></td>
        <td class="px-4 py-2">
          <p (click)="openModal(measure)" class="font-medium text-greenTMKT dark:text-greenTMKT hover:underline cursor-pointer">Aplicar</p>
        </td>
        <td class="px-4 py-2">{{ measure.opE_NRREG }}</td>
        <td class="px-4 py-2">{{ measure.opE_Nome }}</td>
        <td class="px-4 py-2">{{ measure.tsD_Descricao }}</td>
        <td class="px-4 py-2">{{ measure.mdR_Codigo }}</td>
        <td class="px-4 py-2">{{ measure.mdR_DescricaoMedida }}</td>
        <td class="px-4 py-2">{{ measure.mdR_Data }}</td>
        <td class="px-4 py-2">{{ measure.icM_Descricao }}</td>
        <td class="px-4 py-2">{{ measure.suP_Nome }}</td>
        <td class="px-4 py-2">{{ measure.suP_NRREG }}</td>
        <td class="px-4 py-2">Pendente</td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Modal -->
<ng-container *ngIf="isModalOpen" >
<div class="relative z-10" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
  <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
    <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
      <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
        <div class="bg-white px-6 py-4 sm:p-6 sm:pb-4">
          <div class="sm:flex sm:items-start">
            <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
              <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
              </svg>
            </div>
            <div class="mt-3 sm:ml-4 sm:mt-0 sm:text-left items-center px-4">
              <div class="mt-3">
                <h1 class="text-center text-lg font-semibold p-3 border-b border-gray-200 bg-gray-100">Dados do Empregado</h1>
                <div class="my-4">
                  <p class="text-sm text-gray-500"><strong>Nº de Registro:</strong> {{dadosMedidaDisciplinar?.mdR_Codigo}}</p>
                  <p class="text-sm text-gray-500"><strong>Nome:</strong> {{dadosMedidaDisciplinar?.opE_Nome}}</p>
                  <p class="text-sm text-gray-500"><strong>Matrícula:</strong> {{dadosMedidaDisciplinar?.opE_NRREG}}</p>
                  <p class="text-sm text-gray-500"><strong>Operação/Depto:</strong> {{dadosMedidaDisciplinar?.ctR_Descricao}}</p>
                  <p class="text-sm text-gray-500"><strong>Sanção:</strong> {{dadosMedidaDisciplinar?.advertencia}} {{dadosMedidaDisciplinar?.suspensao}}</p>
                  <p class="text-sm text-gray-500"><strong>Data de Retorno:</strong> {{dadosMedidaDisciplinar?.dataretorno}}</p>
                </div>

                <h1 class="text-center text-lg font-semibold p-3 my-3 border-b border-gray-200 bg-gray-100">Descrição da Ocorrência</h1>
                <div class="my-3 border-b border-gray-200 text-center">
                  <p class="text-sm text-gray-500">{{dadosMedidaDisciplinar?.motivo_Medida}}</p>
                  <p class="text-sm text-gray-500">{{dadosMedidaDisciplinar?.mdR_DescricaoMedida}}</p>
                </div>
                <h1 class="text-sm font-bold my-3" >Nome do Gerente de Contas: {{dadosMedidaDisciplinar?.nomE_GESTOR}}</h1>

                <!-- Campos para CPF e Data de Nascimento do Gerente -->
                <div class="flex justify-between items-center my-5" *ngIf="!gerenteValidado">
                    <p class="text-sm text-gray-500"><strong>Assinatura do gerente:</strong></p>
                    <p (click)="validarGerente()" class="text-sm text-greenTMKT dark:text-greenTMKT hover:underline cursor-pointer">Assinar</p>
                    <div class="ml-10 mt-5">
                        <label for="cpfGerente" class="text-sm">CPF Gerente:</label>
                        <input type="text" [(ngModel)]="cpfGerente" placeholder="000.000.000-00" class="border rounded px-2 py-1 w-full" mask="000.000.000-00">
                        <label for="dataNascimentoGerente" class="text-sm mt-2">Data de Nascimento Gerente: </label>
                        <input type="date" [(ngModel)]="dataNascimentoGerente" class="border rounded px-2 py-1 w-full">
                    </div>
                </div>

                <ng-container *ngIf="gerenteValidado">
                    <div class="flex items-center gap-2">
                        <strong class="text-sm">{{ assinaturaGerenteMedida?.mddNomeGerenteContas }}</strong>
                        <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <p class="text-sm"> CPF: {{ assinaturaGerenteMedida?.mddGerenteContasCpf ?? 'N/A' | mask:'000.000.000-00' }}</p>
                    <p class="text-xs whitespace-nowrap"> Assinou em: {{ assinaturaGerenteMedida?.mddGerenteAssinaturaDtHora| date:'dd/MM/yyyy HH:mm:ss' }} </p>
                </ng-container>
                <br>
                <hr>
                <br>
                 <!-- Campos para CPF e Data de Nascimento do Empregado -->
                <div class="flex justify-between items-center my-5" *ngIf="!empregadoValidado">
                  <p class="text-sm text-gray-500"><strong>Assinatura do empregado:</strong></p>
                  <p (click)="validarEmpregado()" class="text-sm text-greenTMKT dark:text-greenTMKT hover:underline cursor-pointer">Assinar</p>

                  <div class="ml-8">
                    <label for="cpfEmpregado" class="text-sm">CPF Empregado:</label>
                    <input id="cpfEmpregado" type="text" class="border rounded px-2 py-1 w-full" placeholder="000.000.000-00" [(ngModel)]="cpfEmpregado" mask="000.000.000-00">
                    <label for="dataNascimentoEmpregado" class="text-sm mt-2">Data de Nascimento Empregado:</label>
                    <input id="dataNascimentoEmpregado" type="date" class="border rounded px-2 py-1 w-full" [(ngModel)]="dataNascimentoEmpregado">
                  </div>
                </div>

                <ng-container *ngIf="empregadoValidado">
                    <div class="flex items-center gap-2">
                        <strong class="text-sm">{{assinaturaEmpregadoObj?.mddNomeEmpregado}}</strong>
                        <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <p class="text-sm"> CPF: {{ assinaturaEmpregadoObj?.mddEmpregadoCPF ?? "S/N"| mask:'000.000.000-00' }}</p>
                    <p class="text-xs whitespace-nowrap"> Assinou em: {{assinaturaEmpregadoObj?.mddEmpregadoAssinaturaDtHora | date:'dd/MM/yyyy HH:mm:ss' }} </p>
                </ng-container>

                <br>
                <hr>
                <br>
                   <!-- Campos para CPF e Data de Nascimento da Testemunha -->
                   <div class="flex justify-between items-center my-5" *ngIf="!testemunhaValidado">
                    <p class="text-sm text-gray-500"><strong>Assinatura da testemunha:</strong></p>
                    <p (click)="validarTestemunha()" class="text-sm text-greenTMKT dark:text-greenTMKT hover:underline cursor-pointer">Assinar</p>

                    <div class="ml-8">
                      <label for="cpfEmpregado" class="text-sm">CPF Testemunha:</label>
                      <input id="cpfEmpregado" type="text" class="border rounded px-2 py-1 w-full" placeholder="000.000.000-00" [(ngModel)]="cpfTestemunha" mask="000.000.000-00">
                      <label for="dataNascimentoEmpregado" class="text-sm mt-2">Data de Nascimento Testemunha:</label>
                      <input id="dataNascimentoEmpregado" type="date" class="border rounded px-2 py-1 w-full" [(ngModel)]="dataNascimentoTestemunha">
                    </div>
                  </div>

                  <ng-container *ngIf="testemunhaValidado">
                      <div class="flex items-center gap-2">
                          <strong class="text-sm">{{assinaturaTestemunhaObj?.mddNomeTestemunha}}</strong>
                          <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                          </svg>
                      </div>
                      <p class="text-sm"> CPF: {{ assinaturaTestemunhaObj?.mddTestemunhaCPF ?? "S/N"| mask:'000.000.000-00' }}</p>
                      <p class="text-xs whitespace-nowrap"> Assinou como testemunha em: {{assinaturaTestemunhaObj?.mddTestemunhaAssinaturaDtHora | date:'dd/MM/yyyy HH:mm:ss' }} </p>
                  </ng-container>
              </div>

              <p class="text-xs mt-2 text-gray-500 mt-10 " >Estou ciente que a reincidência em procedimentos similares/idênticos poderá configurar a rescisão do contrato de trabalho por justa causa.</p>
            </div>
          </div>
        </div>
        <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
          <button type="button" (click)="gerarPDF()" class="inline-flex w-full justify-center rounded-md bg-greenTMKT px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-greenConfirmacao sm:ml-3 sm:w-auto">Confirmar</button>
          <button type="button" (click)="closeModal()" class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">Cancelar</button>
        </div>
      </div>
    </div>
  </div>
</div>


